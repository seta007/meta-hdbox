diff -Naur linux-3.0.8_hisilicon/arch/arm/include/asm/ftrace.h linux-3.0.8_hisilicon-PersianPrince/arch/arm/include/asm/ftrace.h
--- linux-3.0.8_hisilicon/arch/arm/include/asm/ftrace.h	2016-11-25 20:50:09.000000000 +0330
+++ linux-3.0.8_hisilicon-PersianPrince/arch/arm/include/asm/ftrace.h	2021-04-04 18:11:24.966072891 +0430
@@ -45,7 +45,7 @@
 
 #else
 
-extern inline void *return_address(unsigned int level)
+static inline void *return_address(unsigned int level)
 {
 	return NULL;
 }
diff -Naur linux-3.0.8_hisilicon/arch/arm/kernel/return_address.c linux-3.0.8_hisilicon-PersianPrince/arch/arm/kernel/return_address.c
--- linux-3.0.8_hisilicon/arch/arm/kernel/return_address.c	2016-11-25 20:50:09.000000000 +0330
+++ linux-3.0.8_hisilicon-PersianPrince/arch/arm/kernel/return_address.c	2021-04-04 17:36:25.885434910 +0430
@@ -26,7 +26,7 @@
 	struct return_address_data *data = d;
 
 	if (!data->level) {
-		data->addr = (void *)frame->lr;
+		data->addr = (void *)frame->pc;
 
 		return 1;
 	} else {
@@ -41,7 +41,8 @@
 	struct stackframe frame;
 	register unsigned long current_sp asm ("sp");
 
-	data.level = level + 1;
+	data.level = level + 2;
+	data.addr = NULL;
 
 	frame.fp = (unsigned long)__builtin_frame_address(0);
 	frame.sp = current_sp;
@@ -58,15 +59,6 @@
 
 #else /* if defined(CONFIG_FRAME_POINTER) && !defined(CONFIG_ARM_UNWIND) */
 
-#if defined(CONFIG_ARM_UNWIND)
-#warning "TODO: return_address should use unwind tables"
-#endif
-
-void *return_address(unsigned int level)
-{
-	return NULL;
-}
-
 #endif /* if defined(CONFIG_FRAME_POINTER) && !defined(CONFIG_ARM_UNWIND) / else */
 
 EXPORT_SYMBOL_GPL(return_address);
